import numpy as np
import cartpole_sqp_solver

true_weights = np.array([0.0, -1.625, 0.0, 0.0, 0.375, 0.0, 0.0, -58.92, 0.0, 0.0, -0.375, -60.0, 0.6, 0.0, 0.0, -3.25, 0.0, 0.0, 0.0, 0.0, 0.75, -0.4, 0.0, 40.0, 7.365, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

weights = np.array([ -7.62791933e-03,  -2.83696337e-03,  -4.26946169e-01,
         3.06415611e-02,   3.40792819e-03,   9.46294152e-03,
        -4.77269181e-02,  -2.47804899e-01,  -8.11266405e-02,
         1.27176601e-01,   3.89593047e-03,   8.18889565e-02,
         2.14726040e-02,  -7.46168539e-03,   4.28504521e-01,
        -6.41554662e-01,  -2.24042343e-01,   1.32388899e-03,
        -9.42103867e-03,   2.27421303e-01,   6.56662503e-01,
        -1.98470324e-01,  -1.92718198e+01,   4.92766636e-01,
         9.35972238e+00,   7.25657876e-02,  -6.15675746e-01,
         2.18423619e-01,  -1.07010584e-01,  -5.63397695e-04,
        -3.38345705e-02,  -4.83231132e-03,   1.96162084e-01,
         1.56547206e+00,   4.22347214e-03,   3.60282017e-02,
        -1.53649850e+00,  -2.08916369e-02,  -2.94535550e-01,
         9.65199569e-03,   1.90583981e-02,   2.56549548e-01,
        -3.67221754e-02,  -4.14259926e-02,  -1.98625985e-01,
        -1.06860967e+00,  -2.79622671e-01,   3.49545976e-03,
        -4.38836035e-02,   5.45424387e-01,   1.98382731e+00,
        -4.56540166e-01,  -4.11070942e+01,   1.57825860e+01,
         2.38918636e+01,   1.81034417e-01,  -1.76565304e+01,
         5.50534843e-01,  -3.52751338e-01,  -2.65291019e-03])


vc_max = 1000000

collocation_points = 15
nU = 1
pi = np.zeros([collocation_points - 1, nU], dtype=float)

start_state = [0,0,0,0]
start_state = np.array(start_state, dtype=float)
start_state = np.array([ 0.84842527, -0.41865087,  0.46487951, -6.66854698])

success, delta = cartpole_sqp_solver.solve(weights, pi, start_state, vc_max)

if success:
	print "Success!"
	print "Delta: {0}".format(delta)
else:
	print "Failure..."

print "Pi: ", pi