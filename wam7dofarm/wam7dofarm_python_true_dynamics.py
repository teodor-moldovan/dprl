import numpy as np
from numpy import cos, sin

L_1xx= 0.2948635027286643
L_1xy= 0.007950224642941463
L_1xz= 9.310396523921739e-05
L_1yy= 0.11350016774623556
L_1yz= 0.00018710326437239235
L_1zz= 0.25065343014390495
l_1x= -0.04774629602006741
l_1y= 1.3124776494944914
l_1z= -0.0071593278549063
m_1= 10.76768767
L_2xx= 0.026068399567247713
L_2xy= 1.3466772047875293e-05
L_2xz= 0.0001170014538992409
L_2yy= 0.014722016956250276
L_2yz= -3.658929201603989e-05
L_2zz= 0.019348136639933563
l_2x= -0.0091829432778148
l_2y= 0.1203406033546184
l_2z= 0.0597559546040184
m_2= 3.87493756
L_3xx= 0.13671601022982002
L_3xy= 0.016804341893703847
L_3xz= -5.098354246793442e-06
L_3yy= 0.005883535414949282
L_3yz= 5.29476123100595e-06
L_3zz= 0.13951370169796007
l_3x= -0.0689527275069978
l_3y= 0.37398727014185695
l_3z= 5.963749185690001e-05
m_3= 1.80228141
L_4xx= 0.05719268907382418
L_4xy= -1.4664960862005844e-05
L_4xz= -8.193104072137586e-05
L_4yy= 0.057164710331919694
L_4yz= 9.416994916116324e-05
L_4zz= 0.003004403916759314
l_4x= 0.0119651256995648
l_4y= -0.0005506465517368
l_4z= 0.3185421897008248
m_4= 2.40016804
L_5xx= 5.5875116438106664e-05
L_5xy= -2.5644166207300225e-07
L_5xz= 1.8822125803638124e-09
L_5yy= 7.817171765487431e-05
L_5yz= 8.326150732760728e-07
L_5zz= 6.593536865538978e-05
l_5x= 1.10406465499e-05
l_5y= 0.0006326831305123001
l_5z= 0.0005393766104656001
m_5= 0.12376019
L_6xx= 0.0009310667837560834
L_6xy= -1.482919758097513e-06
L_6xz= 2.0050697830214196e-06
L_6yy= 0.0004983343572518748
L_6yz= 0.00022161841983553936
L_6zz= 0.0005748349955269667
l_6x= -5.1251927736799995e-05
l_6y= -0.007118901958061599
l_6z= 0.0103169938266304
m_6= 0.41797364
L_7xx= 3.8450469630123506e-05
L_7xy= 1.9089296612290408e-07
L_7xz= -1.7711087782618944e-08
L_7yy= 3.8779079316551796e-05
L_7yz= 3.623287873060732e-08
L_7zz= 7.408226329976235e-05
l_7x= -5.4739540422e-06
l_7y= 1.11984715689e-05
l_7z= -0.00022211045626559998
m_7= 0.06864753

true_weights = np.array([L_1xx,
 L_1xy,
 L_1xz,
 L_1yy,
 L_1yz,
 L_1zz,
 l_1x,
 l_1y,
 l_1z,
 m_1,
 L_2xx,
 L_2xy,
 L_2xz,
 L_2yy,
 L_2yz,
 L_2zz,
 l_2x,
 l_2y,
 l_2z,
 m_2,
 L_3xx,
 L_3xy,
 L_3xz,
 L_3yy,
 L_3yz,
 L_3zz,
 l_3x,
 l_3y,
 l_3z,
 m_3,
 L_4xx,
 L_4xy,
 L_4xz,
 L_4yy,
 L_4yz,
 L_4zz,
 l_4x,
 l_4y,
 l_4z,
 m_4,
 L_5xx,
 L_5xy,
 L_5xz,
 L_5yy,
 L_5yz,
 L_5zz,
 l_5x,
 l_5y,
 l_5z,
 m_5,
 L_6xx,
 L_6xy,
 L_6xz,
 L_6yy,
 L_6yz,
 L_6zz,
 l_6x,
 l_6y,
 l_6z,
 m_6,
 L_7xx,
 L_7xy,
 L_7xz,
 L_7yy,
 L_7yz,
 L_7zz,
 l_7x,
 l_7y,
 l_7z,
 m_7])


def dynamics(x, u):

    # Max control thing
    #max_control = 1

    # Dimension
    nX = x.shape[0]
    half_NX = nX/2

    # Separate out into dq and q
    dq = x[0:nX/2]
    q = x[nX/2:]

    # Get mass/inertia matrix
    M_mat = np.array(M(true_weights, q)).reshape([half_NX, half_NX])

    # Get coriolis vector
    c_vec = np.array(c(true_weights, q, dq))

    # Get gravity term
    g_vec = np.array(g(true_weights, q))

    # Find ddq by solving the linear equation
    ddq = np.linalg.solve(M_mat, u - c_vec + g_vec) # Reversing gravity, make arm hang from wall
    
    return np.array(np.concatenate((ddq, dq)))


def M(parms, q):
#
    M_out = [0]*49
#
    x0 = cos(q[1])
    x1 = sin(q[2])
    x2 = cos(q[2])
    x3 = 0.045*x1**2 + 0.045*x2**2
    x4 = cos(q[3])
    x5 = -x4
    x6 = -x0
    x7 = x5*x6
    x8 = x4**2
    x9 = sin(q[3])
    x10 = x9**2
    x11 = -0.045*x10 - 0.045*x8
    x12 = sin(q[1])
    x13 = -x12
    x14 = x13*x2
    x15 = x0*x3 - 0.55*x14
    x16 = x14*x9
    x17 = x11*x16 + x11*x7 + x15
    x18 = -parms[46]
    x19 = x16 + x7
    x20 = -x19
    x21 = sin(q[4])
    x22 = x1*x13
    x23 = -x22
    x24 = x21*x23
    x25 = x14*x4 + x6*x9
    x26 = cos(q[4])
    x27 = x25*x26
    x28 = -x21
    x29 = -0.55*x22
    x30 = x23*x3
    x31 = x29*x4 + x30*x9
    x32 = x17*x26 - 0.3*x24 - 0.3*x27 + x28*x31
    x33 = x24 + x27
    x34 = cos(q[5])
    x35 = -x34
    x36 = sin(q[5])
    x37 = x20*x35 + x33*x36
    x38 = cos(q[6])
    x39 = sin(q[6])
    x40 = -x39
    x41 = 0.045*x10 + 0.045*x8
    x42 = x23*x41 + x29*x9 + x30*x5
    x43 = -x42
    x44 = x23*x26
    x45 = x21*x25
    x46 = x17*x21 + x26*x31 + 0.3*x44 - 0.3*x45
    x47 = x34*x46 + x36*x43
    x48 = x44 - x45
    x49 = x39*x48
    x50 = x20*x36 + x33*x34
    x51 = x38*x50
    x52 = x32*x38 + x40*x47 - 0.06*x49 - 0.06*x51
    x53 = -parms[68]
    x54 = x49 + x51
    x55 = parms[66]*x37 + parms[69]*x52 + x53*x54
    x56 = x38*x55
    x57 = -parms[58]
    x58 = -parms[67]
    x59 = x39*x50
    x60 = x38*x48
    x61 = -x59 + x60
    x62 = x32*x39 + x38*x47 - 0.06*x59 + 0.06*x60
    x63 = parms[68]*x61 + parms[69]*x62 + x37*x58
    x64 = parms[47]*x33 + parms[49]*x32 + parms[56]*x37 + parms[59]*x32 + x18*x20 + x39*x63 + x50*x57 + x56
    x65 = x26*x64
    x66 = -parms[57]
    x67 = x38*x63
    x68 = parms[58]*x48 + parms[59]*x47 + x37*x66 + x40*x55 + x67
    x69 = -parms[47]
    x70 = -parms[56]
    x71 = x35*x43 + x36*x46
    x72 = -parms[66]
    x73 = parms[57]*x50 + parms[59]*x71 + parms[67]*x54 + parms[69]*x71 + x48*x70 + x61*x72
    x74 = parms[48]*x20 + parms[49]*x46 + x34*x68 + x36*x73 + x48*x69
    x75 = -parms[38]
    x76 = parms[36]*x19 + parms[39]*x17 + x21*x74 + x25*x75 + x65
    x77 = -parms[26]
    x78 = parms[27]*x14 + parms[29]*x15 + x6*x77 + x76
    x79 = x11*x76
    x80 = -0.06*x39
    x81 = parms[60]*x54 + parms[61]*x61 + parms[62]*x37 + parms[67]*x71 + x52*x53
    x82 = parms[61]*x54 + parms[63]*x61 + parms[64]*x37 + parms[68]*x62 + x71*x72
    x83 = parms[50]*x50 + parms[51]*x48 + parms[52]*x37 + parms[57]*x71 + x32*x57 + x38*x81 + x40*x82 - 0.06*x56 + x63*x80
    x84 = parms[62]*x54 + parms[64]*x61 + parms[65]*x37 + parms[66]*x52 + x58*x62
    x85 = parms[52]*x50 + parms[54]*x48 + parms[55]*x37 + parms[56]*x32 + x47*x66 + x84
    x86 = -parms[48]
    x87 = parms[40]*x33 + parms[41]*x20 + parms[42]*x48 + parms[47]*x32 + x34*x83 + x36*x85 + x43*x86
    x88 = -0.3*x21
    x89 = parms[51]*x50 + parms[53]*x48 + parms[54]*x37 + parms[58]*x47 + x38*x82 + x39*x81 + x55*x80 + 0.06*x67 + x70*x71
    x90 = parms[42]*x33 + parms[44]*x20 + parms[45]*x48 + parms[46]*x43 + x46*x69 + x89
    x91 = parms[30]*x25 + parms[31]*x23 + parms[32]*x19 + parms[37]*x42 + x17*x75 + x26*x87 + x28*x90 - 0.3*x65 + x74*x88
    x92 = -parms[41]*x33 - parms[43]*x20 - parms[44]*x48 - parms[48]*x46 - x18*x32 - x35*x85 - x36*x83
    x93 = -parms[37]
    x94 = parms[32]*x25 + parms[34]*x23 + parms[35]*x19 + parms[36]*x17 + x31*x93 + x92
    x95 = -parms[21]*x14 - parms[23]*x6 - parms[24]*x23 - parms[28]*x29 - x15*x77 - x5*x79 - x5*x94 - x9*x91
    x96 = -x23
    x97 = x26*x74
    x98 = parms[37]*x20 + parms[38]*x23 + parms[39]*x31 + x28*x64 + x97
    x99 = parms[36]*x96 + parms[37]*x25 + parms[39]*x42 - parms[46]*x48 - parms[49]*x43 - x33*x86 - x35*x73 - x36*x68
    x100 = parms[27]*x96 + parms[28]*x6 + parms[29]*x29 + x4*x98 + x9*x99
    x101 = -0.55*x1
    x102 = -parms[28]
    x103 = parms[20]*x14 + parms[21]*x6 + parms[22]*x23 + parms[27]*x15 + x102*x30 + x4*x91 + x79*x9 + x9*x94
    x104 = -x1
    x105 = x3*(parms[26]*x23 + parms[29]*x30 + x102*x14 + x5*x99 + x9*x98)
    x106 = parms[31]*x25 + parms[33]*x23 + parms[34]*x19 + parms[36]*x43 + parms[38]*x31 + x21*x87 + x26*x90 + x64*x88 + 0.3*x97
    x107 = -parms[27]
    x108 = parms[22]*x14 + parms[24]*x6 + parms[25]*x23 + parms[26]*x30 + x106 + x107*x29 + x41*x99
    x109 = parms[11]*x13 + parms[14]*x0 + x1*x103 + 0.55*x100*x2 + x101*x78 + x105*x2 + x108*x2
    x110 = 0.045*x78 + x95
    x111 = x106 + 0.045*x99
    x112 = x1*x4
    x113 = x2*x26
    x114 = x112*x28 + x113
    x115 = x112*x26
    x116 = x115 + x2*x21
    x117 = x1*x9
    x118 = -x117
    x119 = x116*x34 + x118*x36
    x120 = x101 + x11*x117
    x121 = 0.55*x2
    x122 = x2*x3
    x123 = x121*x4 + x122*x9
    x124 = x112*x88 + 0.3*x113 + x120*x21 + x123*x26
    x125 = x121*x9 + x122*x5 + x2*x41
    x126 = -x125
    x127 = x124*x36 + x126*x35
    x128 = x119*x38
    x129 = x114*x39 + x128
    x130 = x114*x38
    x131 = x119*x40 + x130
    x132 = parms[57]*x119 + parms[59]*x127 + parms[67]*x129 + parms[69]*x127 + x114*x70 + x131*x72
    x133 = x116*x36 + x118*x35
    x134 = x124*x34 + x126*x36
    x135 = -0.3*x115 + x120*x26 + x123*x28 + x2*x88
    x136 = x119*x80 + 0.06*x130 + x134*x38 + x135*x39
    x137 = parms[68]*x131 + parms[69]*x136 + x133*x58
    x138 = x137*x38
    x139 = x114*x80 - 0.06*x128 + x134*x40 + x135*x38
    x140 = parms[66]*x133 + parms[69]*x139 + x129*x53
    x141 = parms[58]*x114 + parms[59]*x134 + x133*x66 + x138 + x140*x40
    x142 = parms[48]*x118 + parms[49]*x124 + x114*x69 + x132*x36 + x141*x34
    x143 = x140*x38
    x144 = parms[47]*x116 + parms[49]*x135 + parms[56]*x133 + parms[59]*x135 + x118*x18 + x119*x57 + x137*x39 + x143
    x145 = x144*x26
    x146 = parms[36]*x117 + parms[39]*x120 + x112*x75 + x142*x21 + x145
    x147 = parms[27]*x1 + parms[29]*x101 + x146
    x148 = parms[60]*x129 + parms[61]*x131 + parms[62]*x133 + parms[67]*x127 + x139*x53
    x149 = parms[61]*x129 + parms[63]*x131 + parms[64]*x133 + parms[68]*x136 + x127*x72
    x150 = parms[51]*x119 + parms[53]*x114 + parms[54]*x133 + parms[58]*x134 + x127*x70 + 0.06*x138 + x140*x80 + x148*x39 + x149*x38
    x151 = parms[42]*x116 + parms[44]*x118 + parms[45]*x114 + parms[46]*x126 + x124*x69 + x150
    x152 = parms[50]*x119 + parms[51]*x114 + parms[52]*x133 + parms[57]*x127 + x135*x57 + x137*x80 - 0.06*x143 + x148*x38 + x149*x40
    x153 = parms[62]*x129 + parms[64]*x131 + parms[65]*x133 + parms[66]*x139 + x136*x58
    x154 = parms[52]*x119 + parms[54]*x114 + parms[55]*x133 + parms[56]*x135 + x134*x66 + x153
    x155 = parms[40]*x116 + parms[41]*x118 + parms[42]*x114 + parms[47]*x135 + x126*x86 + x152*x34 + x154*x36
    x156 = parms[30]*x112 + parms[31]*x2 + parms[32]*x117 + parms[37]*x125 + x120*x75 + x142*x88 - 0.3*x145 + x151*x28 + x155*x26
    x157 = x11*x146
    x158 = -parms[41]*x116 - parms[43]*x118 - parms[44]*x114 - parms[48]*x124 - x135*x18 - x152*x36 - x154*x35
    x159 = parms[32]*x112 + parms[34]*x2 + parms[35]*x117 + parms[36]*x120 + x123*x93 + x158
    x160 = -parms[36]
    x161 = parms[37]*x112 + parms[39]*x125 - parms[46]*x114 - parms[49]*x126 - x116*x86 - x132*x35 - x141*x36 + x160*x2
    x162 = x142*x26
    x163 = parms[31]*x112 + parms[33]*x2 + parms[34]*x117 + parms[36]*x126 + parms[38]*x123 + x144*x88 + x151*x26 + x155*x21 + 0.3*x162
    x164 = parms[37]*x118 + parms[38]*x2 + parms[39]*x123 + x144*x28 + x162
    x165 = -parms[21]*x1 - parms[24]*x2 - parms[28]*x121 - x101*x77 + 0.045*x147 - x156*x9 - x157*x5 - x159*x5
    x166 = 0.045*x161 + x163
    x167 = x11*x4 + 0.045
    x168 = -x9
    x169 = x168*x28
    x170 = x168*x26
    x171 = x167*x26 - 0.3*x170
    x172 = x167*x21 + x168*x88
    x173 = x172*x34
    x174 = x170*x34 + x36*x5
    x175 = x169*x38
    x176 = x171*x39 + x173*x38 + x174*x80 + 0.06*x175
    x177 = x170*x36 + x35*x5
    x178 = x174*x40 + x175
    x179 = parms[68]*x178 + parms[69]*x176 + x177*x58
    x180 = x179*x38
    x181 = x174*x38
    x182 = x169*x39 + x181
    x183 = x169*x80 + x171*x38 + x173*x40 - 0.06*x181
    x184 = parms[66]*x177 + parms[69]*x183 + x182*x53
    x185 = parms[58]*x169 + parms[59]*x173 + x177*x66 + x180 + x184*x40
    x186 = x172*x36
    x187 = parms[57]*x174 + parms[59]*x186 + parms[67]*x182 + parms[69]*x186 + x169*x70 + x178*x72
    x188 = parms[48]*x5 + parms[49]*x172 + x169*x69 + x185*x34 + x187*x36
    x189 = x184*x38
    x190 = parms[47]*x170 + parms[49]*x171 + parms[56]*x177 + parms[59]*x171 + x174*x57 + x179*x39 + x18*x5 + x189
    x191 = x190*x26
    x192 = parms[36]*x4 + parms[39]*x167 + x168*x75 + x188*x21 + x191
    x193 = parms[62]*x182 + parms[64]*x178 + parms[65]*x177 + parms[66]*x183 + x176*x58
    x194 = parms[52]*x174 + parms[54]*x169 + parms[55]*x177 + parms[56]*x171 + x173*x66 + x193
    x195 = parms[61]*x182 + parms[63]*x178 + parms[64]*x177 + parms[68]*x176 + x186*x72
    x196 = parms[60]*x182 + parms[61]*x178 + parms[62]*x177 + parms[67]*x186 + x183*x53
    x197 = parms[50]*x174 + parms[51]*x169 + parms[52]*x177 + parms[57]*x186 + x171*x57 + x179*x80 - 0.06*x189 + x195*x40 + x196*x38
    x198 = parms[40]*x170 + parms[41]*x5 + parms[42]*x169 + parms[47]*x171 + x194*x36 + x197*x34
    x199 = parms[51]*x174 + parms[53]*x169 + parms[54]*x177 + parms[58]*x173 + 0.06*x180 + x184*x80 + x186*x70 + x195*x38 + x196*x39
    x200 = parms[42]*x170 + parms[44]*x5 + parms[45]*x169 + x172*x69 + x199
    x201 = -parms[41]*x170 - parms[43]*x5 - parms[44]*x169 - parms[48]*x172 - x171*x18 - x194*x35 - x197*x36
    x202 = parms[31]*x168 + parms[34]*x4 + 0.045*parms[37]*x168 - 0.045*parms[46]*x169 - 0.045*x170*x86 - 0.045*x185*x36 - 0.045*x187*x35 + 0.3*x188*x26 + x190*x88 + x198*x21 + x200*x26
    x203 = x21*x34
    x204 = x21*x36
    x205 = x26*x38
    x206 = x203*x40 + x205
    x207 = 0.3*x26
    x208 = x207*x34 - 0.045*x36
    x209 = x203*x80 + 0.06*x205 + x208*x38 + x39*x88
    x210 = parms[68]*x206 + parms[69]*x209 + x204*x58
    x211 = x203*x38
    x212 = x208*x40 - 0.06*x211 + x26*x80 + x38*x88
    x213 = x211 + x26*x39
    x214 = parms[66]*x204 + parms[69]*x212 + x213*x53
    x215 = x214*x38
    x216 = x210*x38
    x217 = parms[58]*x26 + parms[59]*x208 + x204*x66 + x214*x40 + x216
    x218 = x207*x36 + 0.045*x34
    x219 = parms[57]*x203 + parms[59]*x218 + parms[67]*x213 + parms[69]*x218 + x206*x72 + x26*x70
    x220 = parms[61]*x213 + parms[63]*x206 + parms[64]*x204 + parms[68]*x209 + x218*x72
    x221 = parms[60]*x213 + parms[61]*x206 + parms[62]*x204 + parms[67]*x218 + x212*x53
    x222 = parms[50]*x203 + parms[51]*x26 + parms[52]*x204 + parms[57]*x218 + x210*x80 - 0.06*x215 + x220*x40 + x221*x38 + x57*x88
    x223 = parms[62]*x213 + parms[64]*x206 + parms[65]*x204 + parms[66]*x212 + x209*x58
    x224 = parms[52]*x203 + parms[54]*x26 + parms[55]*x204 + parms[56]*x88 + x208*x66 + x223
    x225 = parms[51]*x203 + parms[53]*x26 + parms[54]*x204 + parms[58]*x208 + x214*x80 + 0.06*x216 + x218*x70 + x220*x38 + x221*x39
    x226 = -parms[41]*x21 - parms[44]*x26 - parms[48]*x207 - x18*x88 - x222*x36 - x224*x35
    x227 = -x36
    x228 = x227*x80
    x229 = x227*x40
    x230 = parms[67]*x35 + parms[68]*x229 + parms[69]*x228
    x231 = x227*x38
    x232 = -0.06*x231
    x233 = parms[60]*x231 + parms[61]*x229 + parms[62]*x34 + x232*x53
    x234 = parms[61]*x231 + parms[63]*x229 + parms[64]*x34 + parms[68]*x228
    x235 = parms[66]*x34 + parms[69]*x232 + x231*x53
    x236 = parms[62]*x231 + parms[64]*x229 + parms[65]*x34 + parms[66]*x232 + x228*x58
    x237 = parms[51]*x227 + parms[54]*x34 + 0.06*x230*x38 + x233*x39 + x234*x38 + x235*x80
    x238 = 0.06*x38
    x239 = parms[62]*x39 + parms[64]*x38 + parms[66]*x80 + x238*x58
#
    M_out[0] = parms[3] - x12*(parms[10]*x13 + parms[12]*x0 + x100*x101 + x103*x2 + x104*x105 + x104*x108 - 0.55*x2*x78) - x6*(parms[12]*x13 + parms[15]*x0 + x3*x78 + x95)
    M_out[1] = x109
    M_out[2] = x110
    M_out[3] = x111
    M_out[4] = x92
    M_out[5] = x89
    M_out[6] = x84
    M_out[7] = x109
    M_out[8] = parms[13] + x1*(parms[20]*x1 + parms[22]*x2 + parms[27]*x101 + x102*x122 + x156*x4 + x157*x9 + x159*x9) + x101*x147 + x121*(parms[29]*x121 + x107*x2 + x161*x9 + x164*x4) + x122*(parms[26]*x2 + parms[29]*x122 + x1*x102 + x161*x5 + x164*x9) + x2*(parms[22]*x1 + parms[25]*x2 + parms[26]*x122 + x107*x121 + x161*x41 + x163)
    M_out[9] = x165
    M_out[10] = x166
    M_out[11] = x158
    M_out[12] = x150
    M_out[13] = x153
    M_out[14] = x110
    M_out[15] = x165
    M_out[16] = parms[23] + 0.09*parms[26] + 0.002025*parms[29] - x11*x192*x5 + 0.045*x192 - x5*(parms[32]*x168 + parms[35]*x4 + parms[36]*x167 + x201) - x9*(parms[30]*x168 + parms[32]*x4 + x167*x75 + x188*x88 - 0.3*x191 + x198*x26 + x200*x28)
    M_out[17] = x202
    M_out[18] = x201
    M_out[19] = x199
    M_out[20] = x193
    M_out[21] = x111
    M_out[22] = x166
    M_out[23] = x202
    M_out[24] = parms[33] - 0.045*parms[36] + 0.002025*parms[39] - 0.045*parms[46]*x26 + 0.002025*parms[49] + 0.045*x160 + x207*(parms[49]*x207 + x217*x34 + x219*x36 + x26*x69) - 0.045*x21*x86 + x21*(parms[40]*x21 + parms[42]*x26 + parms[47]*x88 + 0.045*parms[48] + x222*x34 + x224*x36) - 0.045*x217*x36 - 0.045*x219*x35 + x26*(parms[42]*x21 + parms[45]*x26 - 0.045*parms[46] + x207*x69 + x225) + x88*(parms[47]*x21 + parms[49]*x88 + parms[56]*x204 + parms[59]*x88 + x203*x57 + x210*x39 + x215)
    M_out[25] = x226
    M_out[26] = x225
    M_out[27] = x223
    M_out[28] = x92
    M_out[29] = x158
    M_out[30] = x201
    M_out[31] = x226
    M_out[32] = parms[43] - x35*(parms[52]*x227 + parms[55]*x34 + x236) - x36*(parms[50]*x227 + parms[52]*x34 + x230*x80 + x233*x38 + x234*x40 - 0.06*x235*x38)
    M_out[33] = x237
    M_out[34] = x236
    M_out[35] = x89
    M_out[36] = x150
    M_out[37] = x199
    M_out[38] = x225
    M_out[39] = x237
    M_out[40] = parms[53] + x238*(parms[68]*x38 + parms[69]*x238) + x38*(parms[61]*x39 + parms[63]*x38 + parms[68]*x238) + x39*(parms[60]*x39 + parms[61]*x38 + x53*x80) + x80*(parms[69]*x80 + x39*x53)
    M_out[41] = x239
    M_out[42] = x84
    M_out[43] = x153
    M_out[44] = x193
    M_out[45] = x223
    M_out[46] = x236
    M_out[47] = x239
    M_out[48] = parms[65]
#
    return M_out


def c(parms, q, dq):
#
    c_out = [0]*7
#
    x0 = -dq[0]
    x1 = -cos(q[1])
    x2 = x0*x1
    x3 = -x2
    x4 = dq[1]*x3
    x5 = sin(q[1])
    x6 = x0*x5
    x7 = dq[1]*parms[11] + parms[10]*x6 + parms[12]*x2
    x8 = dq[1]*x6
    x9 = cos(q[2])
    x10 = sin(q[2])
    x11 = 0.045*x10**2 + 0.045*x9**2
    x12 = x10*x6
    x13 = dq[1]*x9
    x14 = -0.55*x12 + 0.55*x13
    x15 = -dq[2]
    x16 = x15 + x3
    x17 = -x12
    x18 = x13 + x17
    x19 = -parms[27]
    x20 = parms[28]*x16 + parms[29]*x14 + x18*x19
    x21 = -x16
    x22 = sin(q[3])
    x23 = dq[1]*x10
    x24 = x6*x9
    x25 = x23 + x24
    x26 = cos(q[3])
    x27 = x16*x22 + x25*x26
    x28 = -x27
    x29 = 0.045*dq[3]
    x30 = x11*x13 + x11*x17
    x31 = -x26
    x32 = x22**2
    x33 = x26**2
    x34 = 0.045*x32 + 0.045*x33
    x35 = x14*x22 + x18*x34 + x30*x31
    x36 = x29 + x35
    x37 = dq[3] + x18
    x38 = -x37
    x39 = parms[36]*x38 + parms[37]*x27 + parms[39]*x36
    x40 = cos(q[4])
    x41 = -x15
    x42 = x4*x9
    x43 = x18*x41 + x42
    x44 = x22*x43
    x45 = -x8
    x46 = x31*x45
    x47 = dq[3]*x27 + x44 + x46
    x48 = -x47
    x49 = -parms[46]
    x50 = sin(q[4])
    x51 = x37*x40
    x52 = x28*x50 + x51
    x53 = -dq[4]
    x54 = -x53
    x55 = -dq[3]
    x56 = x22*x25
    x57 = x16*x31
    x58 = x56 + x57
    x59 = x22*x45 + x26*x43 + x55*x58
    x60 = x40*x59
    x61 = x10*x4
    x62 = -x61
    x63 = x15*x25 + x62
    x64 = x50*x63
    x65 = x52*x54 + x60 + x64
    x66 = -parms[47]
    x67 = -x58
    x68 = x53 + x67
    x69 = x14*x26 + x22*x30
    x70 = 0.045*dq[2]
    x71 = x11*x2 - 0.55*x23 - 0.55*x24
    x72 = x70 + x71
    x73 = -0.045*x32 - 0.045*x33
    x74 = x56*x73 + x57*x73 + x72
    x75 = -0.3*x50
    x76 = x27*x75 + x40*x69 + x50*x74 + 0.3*x51
    x77 = parms[48]*x68 + parms[49]*x76 + x52*x66
    x78 = -x68
    x79 = x11*x8 + x14*x15 - 0.55*x42
    x80 = x28*x29 + x44*x73 + x46*x73 + x79
    x81 = x3*x70 + x41*x71 - 0.55*x61
    x82 = -x25
    x83 = x11*x62 + x70*x82
    x84 = x18*x29 + x22*x83 + x26*x81 + x35*x55
    x85 = -x50
    x86 = x40*x80 + x53*x76 - 0.3*x60 - 0.3*x64 + x84*x85
    x87 = x27*x40
    x88 = x37*x50
    x89 = x87 + x88
    x90 = -x36
    x91 = -parms[48]
    x92 = parms[46]*x52 + parms[49]*x90 + x89*x91
    x93 = cos(q[5])
    x94 = sin(q[5])
    x95 = -x93
    x96 = x68*x95 + x89*x94
    x97 = -dq[5]
    x98 = x48*x94 + x65*x93 + x96*x97
    x99 = -parms[58]
    x100 = cos(q[6])
    x101 = dq[5] + x52
    x102 = sin(q[6])
    x103 = x101*x102
    x104 = x68*x94 + x89*x93
    x105 = x100*x104
    x106 = x103 + x105
    x107 = x100*x101
    x108 = x102*x104
    x109 = x107 - x108
    x110 = -parms[66]
    x111 = x76*x94 + x90*x95
    x112 = parms[67]*x106 + parms[69]*x111 + x109*x110
    x113 = -x106
    x114 = dq[5]*x104 + x48*x95 + x65*x94
    x115 = x40*x74 + x69*x85 - 0.3*x87 - 0.3*x88
    x116 = x76*x93 + x90*x94
    x117 = x100*x116 + x102*x115 + 0.06*x107 - 0.06*x108
    x118 = -dq[6]
    x119 = x40*x63
    x120 = x115*x54 + 0.3*x119 + x40*x84 + x50*x80 + x59*x75
    x121 = dq[3]*x69 + x22*x81 + x31*x83 + x34*x63
    x122 = -x121
    x123 = x111*x97 + x120*x93 + x122*x94
    x124 = -x102
    x125 = x100*x98
    x126 = x119 + x53*x89 + x59*x85
    x127 = x102*x126
    x128 = x100*x86 + x117*x118 + x123*x124 - 0.06*x125 - 0.06*x127
    x129 = dq[6] + x96
    x130 = -x129
    x131 = parms[67]*x130 + parms[68]*x109 + parms[69]*x117
    x132 = dq[6]*x109 + x125 + x127
    x133 = -parms[68]
    x134 = parms[66]*x114 + parms[69]*x128 + x112*x113 + x129*x131 + x132*x133
    x135 = x100*x134
    x136 = -parms[67]
    x137 = x100*x115 - 0.06*x103 - 0.06*x105 + x116*x124
    x138 = parms[66]*x129 + parms[69]*x137 + x106*x133
    x139 = x100*x126
    x140 = -0.06*x102
    x141 = dq[6]*x137 + x100*x123 + x102*x86 + 0.06*x139 + x140*x98
    x142 = x106*x118 + x124*x98 + x139
    x143 = parms[68]*x142 + parms[69]*x141 + x109*x112 + x114*x136 + x130*x138
    x144 = -parms[56]
    x145 = parms[57]*x104 + parms[59]*x111 + x101*x144
    x146 = -x104
    x147 = -x96
    x148 = parms[57]*x147 + parms[58]*x101 + parms[59]*x116
    x149 = parms[47]*x65 + parms[49]*x86 + parms[56]*x114 + parms[59]*x86 + x102*x143 + x135 + x145*x146 + x148*x96 + x48*x49 + x77*x78 + x89*x92 + x98*x99
    x150 = x149*x40
    x151 = -x52
    x152 = -x109
    x153 = dq[5]*x116 + x120*x94 + x122*x95
    x154 = parms[56]*x96 + parms[59]*x115 + x104*x99
    x155 = -x148
    x156 = parms[57]*x98 + parms[59]*x153 + parms[67]*x132 + parms[69]*x153 + x101*x155 + x104*x154 + x106*x138 + x110*x142 + x126*x144 + x131*x152
    x157 = parms[47]*x89 + parms[49]*x115 + x49*x68
    x158 = x100*x143
    x159 = -parms[57]
    x160 = parms[58]*x126 + parms[59]*x123 + x101*x145 + x114*x159 + x124*x134 + x147*x154 + x158
    x161 = parms[48]*x48 + parms[49]*x120 + x126*x66 + x151*x92 + x156*x94 + x157*x68 + x160*x93
    x162 = parms[37]*x67 + parms[38]*x37 + parms[39]*x69
    x163 = -parms[38]
    x164 = parms[36]*x47 + parms[39]*x80 + x150 + x161*x50 + x162*x58 + x163*x59 + x28*x39
    x165 = -parms[26]
    x166 = parms[26]*x18 + parms[28]*x82 + parms[29]*x30
    x167 = parms[27]*x43 + parms[29]*x79 + x164 + x165*x45 + x166*x25 + x20*x21
    x168 = -x69
    x169 = parms[32]*x27 + parms[34]*x37 + parms[35]*x58 + parms[36]*x74 + parms[37]*x168
    x170 = -x111
    x171 = parms[51]*x104 + parms[53]*x101 + parms[54]*x96 + parms[56]*x170 + parms[58]*x116
    x172 = parms[50]*x104 + parms[51]*x101 + parms[52]*x96 + parms[57]*x111 + x115*x99
    x173 = parms[61]*x106 + parms[63]*x109 + parms[64]*x129 + parms[68]*x117 + x110*x111
    x174 = parms[60]*x106 + parms[61]*x109 + parms[62]*x129 + parms[67]*x111 + x133*x137
    x175 = parms[62]*x132 + parms[64]*x142 + parms[65]*x114 + parms[66]*x128 + x106*x173 + x117*x138 - x131*x137 + x136*x141 + x152*x174
    x176 = parms[52]*x98 + parms[54]*x126 + parms[55]*x114 + parms[56]*x86 - x101*x172 + x104*x171 + x115*x155 + x116*x154 + x123*x159 + x175
    x177 = parms[42]*x89 + parms[44]*x68 + parms[45]*x52 + parms[46]*x90 + x66*x76
    x178 = parms[41]*x89 + parms[43]*x68 + parms[44]*x52 + parms[48]*x76 + x115*x49
    x179 = -x117
    x180 = parms[62]*x106 + parms[64]*x109 + parms[65]*x129 + parms[66]*x137 + parms[67]*x179
    x181 = parms[60]*x132 + parms[61]*x142 + parms[62]*x114 + parms[67]*x153 + x109*x180 + x112*x137 + x128*x133 + x130*x173 + x138*x170
    x182 = parms[61]*x132 + parms[63]*x142 + parms[64]*x114 + parms[68]*x141 + x110*x153 + x111*x131 + x112*x179 + x113*x180 + x129*x174
    x183 = -x116
    x184 = parms[52]*x104 + parms[54]*x101 + parms[55]*x96 + parms[56]*x115 + parms[57]*x183
    x185 = parms[50]*x98 + parms[51]*x126 + parms[52]*x114 + parms[57]*x153 + x100*x181 + x101*x184 + x115*x145 + x124*x182 - 0.06*x135 + x140*x143 + x147*x171 + x154*x170 + x86*x99
    x186 = parms[40]*x65 + parms[41]*x48 + parms[42]*x126 + parms[47]*x86 - x115*x92 + x122*x91 + x151*x178 + x157*x90 + x176*x94 + x177*x68 + x185*x93
    x187 = parms[31]*x27 + parms[33]*x37 + parms[34]*x58 + parms[36]*x90 + parms[38]*x69
    x188 = parms[40]*x89 + parms[41]*x68 + parms[42]*x52 + parms[47]*x115 + x90*x91
    x189 = parms[51]*x98 + parms[53]*x126 + parms[54]*x114 + parms[58]*x123 + x100*x182 + x102*x181 + x111*x148 + x134*x140 + x144*x153 + x145*x183 + x146*x184 + 0.06*x158 + x172*x96
    x190 = parms[42]*x65 + parms[44]*x48 + parms[45]*x126 + parms[46]*x122 + x120*x66 + x178*x89 + x188*x78 + x189 + x76*x92 - x77*x90
    x191 = parms[36]*x58 + parms[38]*x28 + parms[39]*x74
    x192 = parms[30]*x59 + parms[31]*x63 + parms[32]*x47 + parms[37]*x121 - 0.3*x150 + x161*x75 + x163*x80 + x169*x37 + x186*x40 + x187*x67 + x190*x85 + x191*x90 + x39*x74
    x193 = parms[22]*x25 + parms[24]*x16 + parms[25]*x18 + parms[26]*x30 + x14*x19
    x194 = parms[27]*x25 + parms[29]*x72 + x16*x165
    x195 = x164*x73
    x196 = -x89
    x197 = -parms[41]*x65 - parms[43]*x48 - parms[44]*x126 - parms[48]*x120 - x115*x77 + x157*x76 - x176*x95 - x177*x196 - x185*x94 - x188*x52 - x49*x86
    x198 = parms[30]*x27 + parms[31]*x37 + parms[32]*x58 + parms[37]*x36 + x163*x74
    x199 = parms[32]*x59 + parms[34]*x63 + parms[35]*x47 + parms[36]*x80 - parms[37]*x84 - x162*x74 + x187*x27 + x191*x69 + x197 + x198*x38
    x200 = -parms[28]
    x201 = parms[20]*x25 + parms[21]*x16 + parms[22]*x18 + parms[27]*x72 + x200*x30
    x202 = -parms[21]*x43 - parms[23]*x45 - parms[24]*x63 - parms[28]*x81 + x14*x194 - x165*x79 - x18*x201 - x192*x22 - x193*x82 - x195*x31 - x199*x31 - x20*x72
    x203 = dq[1]*parms[13] + parms[11]*x6 + parms[14]*x2
    x204 = -x166
    x205 = x161*x40
    x206 = parms[37]*x48 + parms[38]*x63 + parms[39]*x84 + x149*x85 + x191*x67 + x205 + x37*x39
    x207 = -parms[36]*x63 + parms[37]*x59 + parms[39]*x121 - parms[46]*x126 - parms[49]*x122 - x156*x95 - x157*x196 - x160*x94 + x162*x38 + x191*x27 - x52*x77 - x65*x91
    x208 = parms[28]*x45 + parms[29]*x81 + x16*x194 + x18*x204 + x19*x63 + x206*x26 + x207*x22
    x209 = -0.55*x10
    x210 = parms[21]*x25 + parms[23]*x16 + parms[24]*x18 + parms[28]*x14 + x165*x72
    x211 = parms[20]*x43 + parms[21]*x45 + parms[22]*x63 + parms[27]*x79 + x16*x193 - x18*x210 + x192*x26 + x194*x30 + x195*x22 + x199*x22 + x200*x83 + x204*x72
    x212 = parms[31]*x59 + parms[33]*x63 + parms[34]*x47 + parms[36]*x122 + parms[38]*x84 + x149*x75 + x162*x36 + x168*x39 + x169*x28 + x186*x50 + x190*x40 + x198*x58 + 0.3*x205
    x213 = parms[22]*x43 + parms[24]*x45 + parms[25]*x63 + parms[26]*x83 + x14*x166 + x19*x81 - x20*x30 + x201*x21 + x207*x34 + x210*x25 + x212
    x214 = -x10
    x215 = x11*(parms[26]*x63 + parms[29]*x83 + x18*x20 + x194*x82 + x200*x43 + x206*x22 + x207*x31)
    x216 = dq[1]*parms[14] + parms[12]*x6 + parms[15]*x2
#
    c_out[0] = -x1*(-dq[1]*x7 + parms[12]*x4 + parms[15]*x8 + x11*x167 + x202 + x203*x6) - x5*(dq[1]*x216 + parms[10]*x4 + parms[12]*x8 - 0.55*x167*x9 + x203*x3 + x208*x209 + x211*x9 + x213*x214 + x214*x215)
    c_out[1] = parms[11]*x4 + parms[14]*x8 + x10*x211 + x167*x209 + x2*x7 + 0.55*x208*x9 + x213*x9 + x215*x9 - x216*x6
    c_out[2] = 0.045*x167 + x202
    c_out[3] = 0.045*x207 + x212
    c_out[4] = x197
    c_out[5] = x189
    c_out[6] = x175
#
    return c_out

def g(parms, q):
#
    g_out = [0]*7
#
    x0 = sin(q[5])
    x1 = cos(q[5])
    x2 = cos(q[3])
    x3 = cos(q[1])
    x4 = 9.81*x3
    x5 = -x4
    x6 = -x5
    x7 = sin(q[1])
    x8 = -9.81*x7
    x9 = cos(q[2])
    x10 = x8*x9
    x11 = sin(q[3])
    x12 = x10*x11 + x2*x6
    x13 = -x12
    x14 = -x13
    x15 = sin(q[4])
    x16 = sin(q[2])
    x17 = -x16
    x18 = x17*x8
    x19 = x10*x2 + x11*x5
    x20 = cos(q[4])
    x21 = x15*x18 + x19*x20
    x22 = x0*x21 + x1*x14
    x23 = parms[59]*x22 + parms[69]*x22
    x24 = x0*x13 + x1*x21
    x25 = sin(q[6])
    x26 = -x25
    x27 = -x15
    x28 = x18*x20 + x19*x27
    x29 = cos(q[6])
    x30 = x24*x26 + x28*x29
    x31 = parms[69]*x30
    x32 = x24*x29 + x25*x28
    x33 = parms[69]*x32
    x34 = x29*x33
    x35 = parms[59]*x24 + x26*x31 + x34
    x36 = parms[49]*x21 + x0*x23 + x1*x35
    x37 = x15*x36
    x38 = x29*x31
    x39 = parms[49]*x28 + parms[59]*x28 + x25*x33 + x38
    x40 = parms[39]*x18 + x20*x39 + x37
    x41 = x11**2
    x42 = x2**2
    x43 = x40*(-0.045*x41 - 0.045*x42)
    x44 = -x2
    x45 = -x18
    x46 = parms[67]*x22 - parms[68]*x30
    x47 = -x22
    x48 = parms[66]*x47 + parms[68]*x32
    x49 = -0.06*x25
    x50 = parms[56]*x47 + parms[58]*x24 + x25*x46 + x29*x48 + x31*x49 + 0.06*x34
    x51 = parms[46]*x13 - parms[47]*x21 + x50
    x52 = parms[66]*x30 - parms[67]*x32
    x53 = parms[56]*x28 - parms[57]*x24 + x52
    x54 = -x28
    x55 = parms[57]*x22 + parms[58]*x54 + x26*x48 + x29*x46 + x33*x49 - 0.06*x38
    x56 = parms[47]*x28 + parms[48]*x14 + x0*x53 + x1*x55
    x57 = -0.3*x39
    x58 = parms[37]*x12 + parms[38]*x45 + x20*x56 + x20*x57 + x27*x51 - 0.3*x37
    x59 = -x1
    x60 = -parms[46]*x54 - parms[48]*x21 - x0*x55 - x53*x59
    x61 = parms[36]*x18 - parms[37]*x19 + x60
    x62 = -parms[26]*x45 - parms[28]*x10 - x11*x58 - x43*x44 - x44*x61
    x63 = parms[29]*x18 + x40
    x64 = 0.045*x16**2 + 0.045*x9**2
    x65 = x20*x36
    x66 = parms[36]*x13 + parms[38]*x19 + x15*x56 + x15*x57 + x20*x51 + 0.3*x65
    x67 = parms[39]*x12 - parms[49]*x13 - x0*x35 - x23*x59
    x68 = parms[26]*x5 - parms[27]*x10 + x66 + x67*(0.045*x41 + 0.045*x42)
    x69 = parms[27]*x18 + parms[28]*x6 + x11*x43 + x11*x61 + x2*x58
    x70 = parms[39]*x19 + x27*x39 + x65
    x71 = parms[29]*x10 + x11*x67 + x2*x70
    x72 = -0.55*x16
    x73 = x64*(parms[29]*x5 + x11*x70 + x44*x67)
#
    g_out[0] = x3*(-parms[17]*x8 + x62 + x63*x64) - x7*(parms[17]*x4 + x17*x68 + x17*x73 - 0.55*x63*x9 + x69*x9 + x71*x72)
    g_out[1] = parms[16]*x5 + parms[18]*x8 + x16*x69 + x63*x72 + x68*x9 + 0.55*x71*x9 + x73*x9
    g_out[2] = x62 + 0.045*x63
    g_out[3] = x66 + 0.045*x67
    g_out[4] = x60
    g_out[5] = x50
    g_out[6] = x52
#
    return g_out

# Regressor matrix code
def H(q, dq, ddq):
#
    H_out = [0]*490
#
    x0 = -ddq[0]
    x1 = -dq[0]
    x2 = cos(q[1])
    x3 = -x2
    x4 = x1*x3
    x5 = -x4
    x6 = dq[1]*x5
    x7 = sin(q[1])
    x8 = x0*x7 + x6
    x9 = x1*x7
    x10 = dq[1]*x9
    x11 = -x10
    x12 = x5*x9
    x13 = dq[1]**2
    x14 = x9**2
    x15 = x0*x3 + x10
    x16 = x4*x9
    x17 = x4**2
    x18 = dq[1]*x4
    x19 = 9.81*x2
    x20 = -9.81*x7
    x21 = -x20
    x22 = cos(q[2])
    x23 = sin(q[2])
    x24 = x23*x9
    x25 = -x24
    x26 = dq[1]*x22
    x27 = x25 + x26
    x28 = -dq[2]
    x29 = -x28
    x30 = x22*x8
    x31 = ddq[1]*x23
    x32 = x27*x29 + x30 + x31
    x33 = x22*x9
    x34 = dq[1]*x23
    x35 = x33 + x34
    x36 = -x35
    x37 = x28 + x5
    x38 = x36*x37
    x39 = -x23
    x40 = x27*x35
    x41 = -x40
    x42 = x37**2
    x43 = -x42
    x44 = x35**2
    x45 = x43 + x44
    x46 = -ddq[2] - x15
    x47 = x41 + x46
    x48 = x27*x37
    x49 = x32 + x48
    x50 = -x49
    x51 = -x44
    x52 = x27**2
    x53 = -x51 - x52
    x54 = -x48
    x55 = x32 + x54
    x56 = x35*x37
    x57 = ddq[1]*x22
    x58 = x23*x8
    x59 = -x58
    x60 = x28*x35 + x57 + x59
    x61 = x56 + x60
    x62 = x22*x61
    x63 = -x46
    x64 = -x52
    x65 = x42 + x64
    x66 = x40 + x46
    x67 = -x38 - x60
    x68 = -x41
    x69 = x40 + x63
    x70 = 0.045*dq[2]
    x71 = 0.045*x22**2 + 0.045*x23**2
    x72 = -0.55*x33 - 0.55*x34 + x4*x71
    x73 = x70 + x72
    x74 = -x19
    x75 = x36*x70 + x57*x71 + x59*x71 + x74
    x76 = -0.55*x24 + 0.55*x26
    x77 = x27*x76
    x78 = x36*x73 + x75 + x77
    x79 = x39*x78
    x80 = x39*x71
    x81 = x43 + x64
    x82 = -0.55*x23
    x83 = x37*x76
    x84 = 0.045*ddq[2] + x15*x71 + x21*x23 + x28*x76 - 0.55*x30 - 0.55*x31
    x85 = x25*x71 + x26*x71
    x86 = -x36*x85 - x83 + x84
    x87 = x35*x85 - x83 + x84
    x88 = x22*x87
    x89 = x37*x73
    x90 = x20*x22 + x29*x72 + x5*x70 + 0.55*x57 - 0.55*x58
    x91 = x27*x85
    x92 = -x89 - x90 + x91
    x93 = x51 + x64
    x94 = x56 - x60
    x95 = -x32 + x48
    x96 = x43 + x51
    x97 = x35*x73 - x75 - x77
    x98 = x89 + x90 - x91
    x99 = -x98
    x100 = cos(q[3])
    x101 = -x100
    x102 = dq[3] + x27
    x103 = sin(q[3])
    x104 = x100*x35 + x103*x37
    x105 = -x104
    x106 = x102*x105
    x107 = -dq[3]
    x108 = x101*x37
    x109 = x103*x35
    x110 = x108 + x109
    x111 = x100*x32 + x103*x46 + x107*x110
    x112 = -x101*x106 - x103*x111
    x113 = x104*x110
    x114 = x100*x111 + x103*x106
    x115 = x104**2
    x116 = x102**2
    x117 = -x116
    x118 = x115 + x117
    x119 = ddq[3] + x60
    x120 = -x110
    x121 = x104*x120
    x122 = x119 + x121
    x123 = -x101*x118 - x103*x122
    x124 = x100*x122 + x103*x118
    x125 = x102*x110
    x126 = x111 + x125
    x127 = x103*x32
    x128 = x101*x46
    x129 = dq[3]*x104 + x127 + x128
    x130 = x102*x104
    x131 = x129 + x130
    x132 = x103*x131
    x133 = x102*x120
    x134 = x111 + x133
    x135 = -x101*x134 - x132
    x136 = -x115
    x137 = x110**2
    x138 = x136 + x137
    x139 = x100*x131 + x103*x134
    x140 = -x101*x130 - x103*x133
    x141 = x100*x133 + x103*x130
    x142 = -x137
    x143 = x116 + x142
    x144 = x113 + x119
    x145 = x103*x144
    x146 = x100*x143 + x145
    x147 = x106 + x129
    x148 = -x101*x144 - x103*x143
    x149 = x100*x125 + x103*x129
    x150 = -x101*x129 - x103*x125
    x151 = 0.045*dq[3]
    x152 = x103**2
    x153 = x100**2
    x154 = -0.045*x152 - 0.045*x153
    x155 = x105*x151 + x127*x154 + x128*x154 + x84
    x156 = 0.045*x152 + 0.045*x153
    x157 = x101*x85 + x103*x76 + x156*x27
    x158 = x151 + x157
    x159 = x100*x76 + x103*x85
    x160 = x105*x158 + x110*x159 + x155
    x161 = x101*x160
    x162 = x101*x154
    x163 = -x131*x162 - x161
    x164 = x113 - x119
    x165 = x117 + x142
    x166 = x100*x165 + x103*x164
    x167 = x101*x164 + x103*x165
    x168 = x103*x160
    x169 = x132*x154 + x168
    x170 = x102*x159
    x171 = x108*x154 + x109*x154 + x73
    x172 = 0.045*ddq[3] + dq[3]*x159 + x101*x75 + x103*x90 + x156*x60
    x173 = -x172
    x174 = x105*x171 + x170 + x173
    x175 = x156*x164 + x174
    x176 = -x129
    x177 = x130 + x176
    x178 = x101*x126 + x103*x177
    x179 = x100*x177 + x103*x126
    x180 = x136 + x142
    x181 = x126*x156
    x182 = x104*x171 - x170 + x172
    x183 = -x158
    x184 = x100*x90 + x103*x75 + x107*x157 + x151*x27
    x185 = x102*x183 + x110*x171 - x184
    x186 = x103*x154
    x187 = x100*x182 + x103*x185 + x180*x186
    x188 = x103*x182
    x189 = -x101*x185 - x162*x180 - x188
    x190 = -x111 + x125
    x191 = x102*x158 + x120*x171 + x184
    x192 = x117 + x136
    x193 = x156*x192 + x191
    x194 = x104*x158 + x120*x159 - x155
    x195 = x100*x194 + x186*x190
    x196 = x101*x192 + x145
    x197 = x100*x144 + x103*x192
    x198 = -x103*x194 - x162*x190
    x199 = -x154*x161
    x200 = x154*x168
    x201 = x100*x191 + x188
    x202 = x156*x182
    x203 = x101*x182 + x103*x191
    x204 = sin(q[4])
    x205 = x102*x204
    x206 = cos(q[4])
    x207 = x104*x206
    x208 = x205 + x207
    x209 = x102*x206
    x210 = x105*x204 + x209
    x211 = x208*x210
    x212 = -x211
    x213 = -dq[4]
    x214 = x120 + x213
    x215 = x208*x214
    x216 = -x215
    x217 = -x204
    x218 = -x213
    x219 = x119*x204
    x220 = x111*x206
    x221 = x210*x218 + x219 + x220
    x222 = x206*x221 + x216*x217
    x223 = -x101*x212 - x103*x222
    x224 = x204*x221 + x206*x216
    x225 = x100*x222 + x103*x212
    x226 = x208**2
    x227 = x214**2
    x228 = -x227
    x229 = x226 + x228
    x230 = -ddq[4] + x176
    x231 = x212 + x230
    x232 = x204*x231 + x206*x229
    x233 = x210*x214
    x234 = x221 + x233
    x235 = -x234
    x236 = x206*x231 + x217*x229
    x237 = x100*x236 + x103*x235
    x238 = -x101*x235 - x103*x236
    x239 = -x226
    x240 = x210**2
    x241 = -x239 - x240
    x242 = x119*x206
    x243 = x111*x217 + x208*x213 + x242
    x244 = x215 + x243
    x245 = -x233
    x246 = x221 + x245
    x247 = x206*x244 + x217*x246
    x248 = x100*x247 + x103*x241
    x249 = x204*x244 + x206*x246
    x250 = -x101*x241 - x103*x247
    x251 = -x230
    x252 = x206*x245 + x215*x217
    x253 = x100*x252 + x103*x251
    x254 = x204*x245 + x206*x215
    x255 = -x101*x251 - x103*x252
    x256 = x211 + x230
    x257 = -x240
    x258 = x227 + x257
    x259 = x206*x258 + x217*x256
    x260 = -x216 - x243
    x261 = -x101*x260 - x103*x259
    x262 = x206*x256
    x263 = x204*x258 + x262
    x264 = x100*x259 + x103*x260
    x265 = x206*x233 + x217*x243
    x266 = -x212
    x267 = -x101*x266 - x103*x265
    x268 = x204*x233 + x206*x243
    x269 = x100*x265 + x103*x266
    x270 = x211 + x251
    x271 = x206*x270
    x272 = x228 + x257
    x273 = -0.3*x204
    x274 = x104*x273 + x159*x206 + x171*x204 + 0.3*x209
    x275 = x210*x274
    x276 = -x208
    x277 = x159*x217 + x171*x206 - 0.3*x205 - 0.3*x207
    x278 = x173 + x275 + x276*x277
    x279 = x217*x278 - 0.3*x271 + x272*x273
    x280 = x155*x206 + x184*x217 + x213*x274 - 0.3*x219 - 0.3*x220
    x281 = -x280
    x282 = x214*x274
    x283 = -x183*x276 - x281 - x282
    x284 = x204*x272 + x271
    x285 = -x101*x283 - x103*x279 - x162*x284
    x286 = x206*x272
    x287 = x206*x278 + x270*x273 + 0.3*x286
    x288 = -x244
    x289 = x156*x288 + x287
    x290 = x217*x270 + x286
    x291 = x100*x290 + x103*x288
    x292 = x101*x288 + x103*x290
    x293 = x100*x279 + x103*x283 + x186*x284
    x294 = x183*x208 + x280 - x282
    x295 = x206*x294
    x296 = x214*x277
    x297 = x183*x210
    x298 = x111*x273 + x155*x204 + x184*x206 + x218*x277 + 0.3*x242
    x299 = -x296 + x297 - x298
    x300 = x206*x234
    x301 = x215 - x243
    x302 = x217*x299 + x273*x301 + x295 - 0.3*x300
    x303 = x204*x301 + x300
    x304 = -x103*x302 - x162*x303
    x305 = x100*x302 + x186*x303
    x306 = -x239 - x257
    x307 = x206*x301
    x308 = x217*x234 + x307
    x309 = x101*x306 + x103*x308
    x310 = x204*x294 + x206*x299 + x234*x273 + 0.3*x307
    x311 = x156*x306 + x310
    x312 = x100*x308 + x103*x306
    x313 = x296 - x297 + x298
    x314 = -x313
    x315 = x228 + x239
    x316 = x206*x315
    x317 = x204*x256 + x316
    x318 = -x173 + x208*x277 - x275
    x319 = x206*x318 + x256*x273 - 0.3*x316
    x320 = -x101*x314 - x103*x319 - x162*x317
    x321 = x221 - x233
    x322 = x204*x318 + 0.3*x262 + x273*x315
    x323 = x156*x321 + x322
    x324 = x217*x315 + x262
    x325 = x100*x324 + x103*x321
    x326 = x100*x319 + x103*x314 + x186*x317
    x327 = x101*x321 + x103*x324
    x328 = -x278
    x329 = x206*x313
    x330 = x217*x294 + x329
    x331 = x100*x330 + x103*x328
    x332 = x204*x313 + x295
    x333 = x273*x294 + 0.3*x329
    x334 = x156*x328 + x333
    x335 = x101*x328 + x103*x330
    x336 = x273*x313 - 0.3*x295
    x337 = x100*x336 + x186*x332
    x338 = -x103*x336 - x162*x332
    x339 = cos(q[5])
    x340 = sin(q[5])
    x341 = x208*x339 + x214*x340
    x342 = dq[5] + x210
    x343 = x341*x342
    x344 = -x343
    x345 = -x339
    x346 = x208*x340 + x214*x345
    x347 = -dq[5]
    x348 = x221*x339 + x230*x340 + x346*x347
    x349 = -x340*x348 - x344*x345
    x350 = x339*x348 + x340*x344
    x351 = x341*x346
    x352 = x206*x350 + x217*x351
    x353 = x100*x352 + x103*x349
    x354 = x204*x350 + x206*x351
    x355 = -x101*x349 - x103*x352
    x356 = x342**2
    x357 = -x356
    x358 = x341**2
    x359 = x357 + x358
    x360 = -x351
    x361 = ddq[5] + x243
    x362 = x360 + x361
    x363 = -x340*x362 - x345*x359
    x364 = x342*x346
    x365 = x348 + x364
    x366 = x339*x362 + x340*x359
    x367 = x206*x366 + x217*x365
    x368 = -x101*x363 - x103*x367
    x369 = x204*x366 + x206*x365
    x370 = x100*x367 + x103*x363
    x371 = -x358
    x372 = x346**2
    x373 = x371 + x372
    x374 = -x364
    x375 = x348 + x374
    x376 = dq[5]*x341 + x221*x340 + x230*x345
    x377 = x343 + x376
    x378 = x339*x377 + x340*x375
    x379 = x204*x378 + x206*x373
    x380 = -x340*x377 - x345*x375
    x381 = x206*x378 + x217*x373
    x382 = x100*x381 + x103*x380
    x383 = -x101*x380 - x103*x381
    x384 = -x340*x374 - x343*x345
    x385 = x339*x374 + x340*x343
    x386 = x206*x385 + x217*x361
    x387 = -x101*x384 - x103*x386
    x388 = x204*x385 + x206*x361
    x389 = x100*x386 + x103*x384
    x390 = x351 + x361
    x391 = x340*x390
    x392 = -x372
    x393 = x356 + x392
    x394 = x339*x393 + x391
    x395 = x344 + x376
    x396 = x204*x394 + x206*x395
    x397 = -x340*x393 - x345*x390
    x398 = x206*x394 + x217*x395
    x399 = x100*x398 + x103*x397
    x400 = -x101*x397 - x103*x398
    x401 = x339*x364 + x340*x376
    x402 = x206*x401 + x217*x360
    x403 = -x340*x364 - x345*x376
    x404 = -x101*x403 - x103*x402
    x405 = x100*x402 + x103*x403
    x406 = x204*x401 + x206*x360
    x407 = x357 + x392
    x408 = x351 - x361
    x409 = x339*x407 + x340*x408
    x410 = x206*x409
    x411 = x183*x340 + x274*x339
    x412 = x346*x411
    x413 = -x341
    x414 = x183*x345 + x274*x340
    x415 = x280 + x412 + x413*x414
    x416 = x340*x415
    x417 = dq[5]*x411 + x173*x345 + x298*x340
    x418 = -x417
    x419 = x342*x411
    x420 = x277*x413 + x418 + x419
    x421 = x204*x416 + x206*x420 + x273*x377 + 0.3*x410
    x422 = -x340*x407 - x345*x408
    x423 = x156*x422 + x421
    x424 = x206*x377
    x425 = x204*x409 + x424
    x426 = x217*x377 + x410
    x427 = x100*x426 + x103*x422
    x428 = x101*x422 + x103*x426
    x429 = x206*x416 + x217*x420 + x273*x409 - 0.3*x424
    x430 = -x345*x415
    x431 = x100*x429 + x103*x430 + x186*x425
    x432 = -x101*x430 - x103*x429 - x162*x425
    x433 = x277*x346
    x434 = x173*x340 + x298*x339 + x347*x414
    x435 = x342*x414
    x436 = x433 - x434 - x435
    x437 = x277*x341 + x417 - x419
    x438 = x339*x437 + x340*x436
    x439 = x343 - x376
    x440 = x339*x439 + x340*x365
    x441 = x371 + x392
    x442 = x206*x441
    x443 = x206*x438 + x273*x440 - 0.3*x442
    x444 = x204*x440 + x442
    x445 = x340*x437
    x446 = -x345*x436 - x445
    x447 = -x101*x446 - x103*x443 - x162*x444
    x448 = -x340*x439 - x345*x365
    x449 = x206*x440
    x450 = x217*x441 + x449
    x451 = x101*x448 + x103*x450
    x452 = x100*x443 + x103*x446 + x186*x444
    x453 = x204*x438 + x273*x441 + 0.3*x449
    x454 = x156*x448 + x453
    x455 = x100*x450 + x103*x448
    x456 = -x348 + x364
    x457 = x357 + x371
    x458 = x339*x390 + x340*x457
    x459 = x206*x458
    x460 = x217*x456 + x459
    x461 = -x345*x457 - x391
    x462 = x100*x460 + x103*x461
    x463 = x101*x461 + x103*x460
    x464 = -x433 + x434 + x435
    x465 = x281 + x341*x414 - x412
    x466 = x339*x465
    x467 = x204*x466 + x206*x464 + x273*x456 + 0.3*x459
    x468 = x156*x461 + x467
    x469 = -x340*x465
    x470 = x206*x456
    x471 = x206*x466 + x217*x464 + x273*x458 - 0.3*x470
    x472 = x204*x458 + x470
    x473 = x100*x471 + x103*x469 + x186*x472
    x474 = -x101*x469 - x103*x471 - x162*x472
    x475 = x206*x415
    x476 = x339*x464 + x445
    x477 = x204*x476 + x475
    x478 = x273*x476 - 0.3*x475
    x479 = -x103*x478 - x162*x477
    x480 = -x340*x464 - x345*x437
    x481 = x206*x476
    x482 = x217*x415 + x481
    x483 = x101*x480 + x103*x482
    x484 = x100*x478 + x186*x477
    x485 = x100*x482 + x103*x480
    x486 = x273*x415 + 0.3*x481
    x487 = x156*x480 + x486
    x488 = cos(q[6])
    x489 = x341*x488
    x490 = sin(q[6])
    x491 = x342*x490
    x492 = x489 + x491
    x493 = x342*x488
    x494 = x341*x490
    x495 = x493 - x494
    x496 = x492*x495
    x497 = -x496
    x498 = dq[6] + x346
    x499 = x492*x498
    x500 = -x490
    x501 = x348*x488
    x502 = x361*x490
    x503 = dq[6]*x495 + x501 + x502
    x504 = x488*x503 + x499*x500
    x505 = -x340*x504 - x345*x497
    x506 = x488*x499 + x490*x503
    x507 = x339*x504 + x340*x497
    x508 = x206*x507 + x217*x506
    x509 = -x101*x505 - x103*x508
    x510 = x100*x508 + x103*x505
    x511 = x204*x507 + x206*x506
    x512 = x495*x498
    x513 = x503 + x512
    x514 = x361*x488
    x515 = -dq[6]
    x516 = x348*x500 + x492*x515 + x514
    x517 = -x499
    x518 = x516 + x517
    x519 = x488*x513 + x490*x518
    x520 = x492**2
    x521 = x495**2
    x522 = -x521
    x523 = x520 + x522
    x524 = x488*x518 + x500*x513
    x525 = x339*x524 + x340*x523
    x526 = x204*x525 + x206*x519
    x527 = x206*x525 + x217*x519
    x528 = -x340*x524 - x345*x523
    x529 = x100*x527 + x103*x528
    x530 = -x101*x528 - x103*x527
    x531 = -x512
    x532 = x503 + x531
    x533 = ddq[6] + x376
    x534 = x496 + x533
    x535 = x488*x534
    x536 = -x520
    x537 = x498**2
    x538 = x536 + x537
    x539 = x500*x538 + x535
    x540 = -x340*x539 - x345*x532
    x541 = x490*x534
    x542 = x488*x538 + x541
    x543 = x339*x539 + x340*x532
    x544 = x206*x543 + x217*x542
    x545 = -x101*x540 - x103*x544
    x546 = x204*x543 + x206*x542
    x547 = x100*x544 + x103*x540
    x548 = x488*x531 + x500*x516
    x549 = x339*x548 + x340*x496
    x550 = x488*x516 + x490*x531
    x551 = x204*x549 + x206*x550
    x552 = -x340*x548 - x345*x496
    x553 = x206*x549 + x217*x550
    x554 = x100*x553 + x103*x552
    x555 = -x101*x552 - x103*x553
    x556 = x499 + x516
    x557 = -x537
    x558 = x521 + x557
    x559 = x497 + x533
    x560 = x488*x558 + x500*x559
    x561 = -x340*x560 - x345*x556
    x562 = x488*x559 + x490*x558
    x563 = x339*x560 + x340*x556
    x564 = x206*x563 + x217*x562
    x565 = -x101*x561 - x103*x564
    x566 = x204*x563 + x206*x562
    x567 = x100*x564 + x103*x561
    x568 = x488*x512 + x500*x517
    x569 = -x340*x568 - x345*x533
    x570 = x488*x517 + x490*x512
    x571 = x339*x568 + x340*x533
    x572 = x206*x571 + x217*x570
    x573 = -x101*x569 - x103*x572
    x574 = x100*x572 + x103*x569
    x575 = x204*x571 + x206*x570
    x576 = x499 - x516
    x577 = x522 + x557
    x578 = x488*x577
    x579 = x500*x534 + x578
    x580 = -x340*x579 - x345*x576
    x581 = x490*x577 + x535
    x582 = x339*x579 + x340*x576
    x583 = x206*x582
    x584 = x217*x581 + x583
    x585 = x100*x584 + x103*x580
    x586 = x277*x490 + x411*x488 + 0.06*x493 - 0.06*x494
    x587 = x495*x586
    x588 = -x492
    x589 = x277*x488 + x411*x500 - 0.06*x489 - 0.06*x491
    x590 = x418 + x587 + x588*x589
    x591 = x488*x590 - 0.06*x541 + 0.06*x578
    x592 = -0.06*x490
    x593 = x500*x590 - 0.06*x535 + x577*x592
    x594 = x498*x586
    x595 = x280*x488 + x434*x500 - 0.06*x501 - 0.06*x502 + x515*x586
    x596 = x414*x588 + x594 + x595
    x597 = x339*x593 + x340*x596
    x598 = x204*x597 + x206*x591 + x273*x581 + 0.3*x583
    x599 = x156*x580 + x598
    x600 = -x340*x593 - x345*x596
    x601 = x206*x581
    x602 = x206*x597 + x217*x591 + x273*x582 - 0.3*x601
    x603 = x204*x582 + x601
    x604 = x100*x602 + x103*x600 + x186*x603
    x605 = x101*x580 + x103*x584
    x606 = -x101*x600 - x103*x602 - x162*x603
    x607 = x496 - x533
    x608 = x488*x607
    x609 = x536 + x557
    x610 = x500*x609 + x608
    x611 = x339*x610 + x340*x513
    x612 = x488*x609
    x613 = x490*x607 + x612
    x614 = x206*x613
    x615 = x204*x611 + x614
    x616 = x414*x495
    x617 = x498*x589
    x618 = dq[6]*x589 + x280*x490 + x348*x592 + x434*x488 + 0.06*x514
    x619 = -x616 + x617 - x618
    x620 = x417 + x492*x589 - x587
    x621 = x488*x620 + x592*x607 - 0.06*x612
    x622 = x339*x621 + x340*x619
    x623 = x490*x620 + x592*x609 + 0.06*x608
    x624 = x206*x622 + x217*x623 + x273*x611 - 0.3*x614
    x625 = -x340*x621 - x345*x619
    x626 = -x101*x625 - x103*x624 - x162*x615
    x627 = -x340*x610 - x345*x513
    x628 = x206*x611
    x629 = x204*x622 + x206*x623 + x273*x613 + 0.3*x628
    x630 = x156*x627 + x629
    x631 = x217*x613 + x628
    x632 = x101*x627 + x103*x631
    x633 = x100*x624 + x103*x625 + x186*x615
    x634 = x100*x631 + x103*x627
    x635 = -x503 + x512
    x636 = x488*x635
    x637 = x490*x556 + x636
    x638 = x488*x556
    x639 = x500*x635 + x638
    x640 = x522 + x536
    x641 = x339*x639 + x340*x640
    x642 = x206*x641
    x643 = x217*x637 + x642
    x644 = -x340*x639 - x345*x640
    x645 = x100*x643 + x103*x644
    x646 = x414*x492 - x594 - x595
    x647 = x616 - x617 + x618
    x648 = x488*x646 + x500*x647 + x556*x592 - 0.06*x636
    x649 = x339*x648
    x650 = x488*x647
    x651 = x490*x646 + x592*x635 + 0.06*x638 + x650
    x652 = x204*x649 + x206*x651 + x273*x637 + 0.3*x642
    x653 = x156*x644 + x652
    x654 = x206*x637
    x655 = x204*x641 + x654
    x656 = -x340*x648
    x657 = x206*x649 + x217*x651 + x273*x641 - 0.3*x654
    x658 = x100*x657 + x103*x656 + x186*x655
    x659 = x101*x644 + x103*x643
    x660 = -x101*x656 - x103*x657 - x162*x655
    x661 = x488*x596
    x662 = x490*x647 + x661
    x663 = x206*x662
    x664 = x500*x596 + x650
    x665 = x339*x664 + x340*x620
    x666 = x204*x665 + x663
    x667 = x592*x647 - 0.06*x661
    x668 = -x340*x667
    x669 = x339*x667
    x670 = x592*x596 + 0.06*x650
    x671 = x206*x669 + x217*x670 + x273*x665 - 0.3*x663
    x672 = -x101*x668 - x103*x671 - x162*x666
    x673 = -x340*x664 - x345*x620
    x674 = x206*x665
    x675 = x204*x669 + x206*x670 + x273*x662 + 0.3*x674
    x676 = x156*x673 + x675
    x677 = x217*x662 + x674
    x678 = x100*x677 + x103*x673
    x679 = x101*x673 + x103*x677
    x680 = x100*x671 + x103*x668 + x186*x666
    x681 = x22*x66
    x682 = x22*x78
    x683 = x22*x71
#
    # H_out[0] = 0
    # H_out[1] = 0
    # H_out[2] = 0
    H_out[3] = -x0
    # H_out[4] = 0
    # H_out[5] = 0
    # H_out[6] = 0
    # H_out[7] = 0
    # H_out[8] = 0
    # H_out[9] = 0
    H_out[10] = -x11*x3 - x7*x8
    H_out[11] = -x3*(-x13 + x14) - x7*(ddq[1] + x12)
    H_out[12] = -x3*(x6 + x8) - x7*(x10 + x15)
    H_out[13] = -x10*x3 - x6*x7
    H_out[14] = -x3*(ddq[1] + x16) - x7*(x13 - x17)
    H_out[15] = -x15*x3 - x18*x7
    # H_out[16] = 0
    H_out[17] = -x19*x7 - x21*x3
    # H_out[18] = 0
    # H_out[19] = 0
    H_out[20] = -x3*x41 - x7*(x22*x32 + x38*x39)
    H_out[21] = -x3*x50 - x7*(x22*x47 + x39*x45)
    H_out[22] = -x3*x53 - x7*(x39*x55 + x62)
    H_out[23] = -x3*x63 - x7*(x22*x54 + x39*x56)
    H_out[24] = -x3*x67 - x7*(x22*x65 + x39*x66)
    H_out[25] = -x3*x68 - x7*(x22*x48 + x39*x60)
    H_out[26] = -x3*(x69*x71 + x86) - x7*(-0.55*x22*x69 + x61*x80 + x79 + x81*x82)
    H_out[27] = -x3*x49*x71 - x7*(-0.55*x22*x49 + x39*x92 + x80*x93 + x82*x94 + x88)
    H_out[28] = -x3*(x71*x96 + x99) - x7*(-0.55*x22*x96 + x22*x97 + x66*x82 + x80*x95)
    H_out[29] = -x3*x71*x87 - x7*(x71*x79 + x82*x98 - 0.55*x88)
    H_out[30] = -x112*x3 - x7*(x113*x39 + x114*x22)
    H_out[31] = -x123*x3 - x7*(x124*x22 + x126*x39)
    H_out[32] = -x135*x3 - x7*(x138*x39 + x139*x22)
    H_out[33] = -x140*x3 - x7*(x119*x39 + x141*x22)
    H_out[34] = -x148*x3 - x7*(x146*x22 + x147*x39)
    H_out[35] = -x150*x3 - x7*(x121*x39 + x149*x22)
    H_out[36] = -x3*(x131*x71 + x163) - x7*(-0.55*x131*x22 + x166*x82 + x167*x80 + x169*x22 + x175*x39)
    H_out[37] = -x3*(x180*x71 + x189) - x7*(x178*x80 + x179*x82 - 0.55*x180*x22 + x181*x39 + x187*x22)
    H_out[38] = -x3*(x190*x71 + x198) - x7*(-0.55*x190*x22 + x193*x39 + x195*x22 + x196*x80 + x197*x82)
    H_out[39] = -x3*(x160*x71 + x199) - x7*(-0.55*x160*x22 + x200*x22 + x201*x82 + x202*x39 + x203*x80)
    H_out[40] = -x223*x3 - x7*(x22*x225 + x224*x39)
    H_out[41] = -x238*x3 - x7*(x22*x237 + x232*x39)
    H_out[42] = -x250*x3 - x7*(x22*x248 + x249*x39)
    H_out[43] = -x255*x3 - x7*(x22*x253 + x254*x39)
    H_out[44] = -x261*x3 - x7*(x22*x264 + x263*x39)
    H_out[45] = -x267*x3 - x7*(x22*x269 + x268*x39)
    H_out[46] = -x3*(x284*x71 + x285) - x7*(-0.55*x22*x284 + x22*x293 + x289*x39 + x291*x82 + x292*x80)
    H_out[47] = -x3*(x303*x71 + x304) - x7*(-0.55*x22*x303 + x22*x305 + x309*x80 + x311*x39 + x312*x82)
    H_out[48] = -x3*(x317*x71 + x320) - x7*(-0.55*x22*x317 + x22*x326 + x323*x39 + x325*x82 + x327*x80)
    H_out[49] = -x3*(x332*x71 + x338) - x7*(-0.55*x22*x332 + x22*x337 + x331*x82 + x334*x39 + x335*x80)
    H_out[50] = -x3*x355 - x7*(x22*x353 + x354*x39)
    H_out[51] = -x3*x368 - x7*(x22*x370 + x369*x39)
    H_out[52] = -x3*x383 - x7*(x22*x382 + x379*x39)
    H_out[53] = -x3*x387 - x7*(x22*x389 + x388*x39)
    H_out[54] = -x3*x400 - x7*(x22*x399 + x39*x396)
    H_out[55] = -x3*x404 - x7*(x22*x405 + x39*x406)
    H_out[56] = -x3*(x425*x71 + x432) - x7*(-0.55*x22*x425 + x22*x431 + x39*x423 + x427*x82 + x428*x80)
    H_out[57] = -x3*(x444*x71 + x447) - x7*(-0.55*x22*x444 + x22*x452 + x39*x454 + x451*x80 + x455*x82)
    H_out[58] = -x3*(x472*x71 + x474) - x7*(-0.55*x22*x472 + x22*x473 + x39*x468 + x462*x82 + x463*x80)
    H_out[59] = -x3*(x477*x71 + x479) - x7*(-0.55*x22*x477 + x22*x484 + x39*x487 + x483*x80 + x485*x82)
    H_out[60] = -x3*x509 - x7*(x22*x510 + x39*x511)
    H_out[61] = -x3*x530 - x7*(x22*x529 + x39*x526)
    H_out[62] = -x3*x545 - x7*(x22*x547 + x39*x546)
    H_out[63] = -x3*x555 - x7*(x22*x554 + x39*x551)
    H_out[64] = -x3*x565 - x7*(x22*x567 + x39*x566)
    H_out[65] = -x3*x573 - x7*(x22*x574 + x39*x575)
    H_out[66] = -x3*(x603*x71 + x606) - x7*(-0.55*x22*x603 + x22*x604 + x39*x599 + x585*x82 + x605*x80)
    H_out[67] = -x3*(x615*x71 + x626) - x7*(-0.55*x22*x615 + x22*x633 + x39*x630 + x632*x80 + x634*x82)
    H_out[68] = -x3*(x655*x71 + x660) - x7*(-0.55*x22*x655 + x22*x658 + x39*x653 + x645*x82 + x659*x80)
    H_out[69] = -x3*(x666*x71 + x672) - x7*(-0.55*x22*x666 + x22*x680 + x39*x676 + x678*x82 + x679*x80)
    # H_out[70] = 0
    # H_out[71] = 0
    # H_out[72] = 0
    # H_out[73] = 0
    # H_out[74] = 0
    # H_out[75] = 0
    # H_out[76] = 0
    # H_out[77] = 0
    # H_out[78] = 0
    # H_out[79] = 0
    H_out[80] = x16
    H_out[81] = x18 + x8
    H_out[82] = -x14 + x17
    H_out[83] = ddq[1]
    H_out[84] = x11 + x15
    H_out[85] = x12
    H_out[86] = x74
    H_out[87] = 0
    H_out[88] = x20
    H_out[89] = 0
    H_out[90] = x22*x38 + x23*x32
    H_out[91] = x22*x45 + x23*x47
    H_out[92] = x22*x55 + x23*x61
    H_out[93] = x22*x56 + x23*x54
    H_out[94] = x23*x65 + x681
    H_out[95] = x22*x60 + x23*x48
    H_out[96] = 0.55*x22*x81 + x62*x71 + x682 + x69*x82
    H_out[97] = x22*x92 + 0.55*x22*x94 + x23*x87 + x49*x82 + x683*x93
    H_out[98] = x23*x97 + 0.55*x681 + x683*x95 + x82*x96
    H_out[99] = 0.55*x22*x98 + x682*x71 + x82*x87
    H_out[100] = x113*x22 + x114*x23
    H_out[101] = x124*x23 + x126*x22
    H_out[102] = x138*x22 + x139*x23
    H_out[103] = x119*x22 + x141*x23
    H_out[104] = x146*x23 + x147*x22
    H_out[105] = x121*x22 + x149*x23
    H_out[106] = x131*x82 + 0.55*x166*x22 + x167*x683 + x169*x23 + x175*x22
    H_out[107] = x178*x683 + 0.55*x179*x22 + x180*x82 + x181*x22 + x187*x23
    H_out[108] = x190*x82 + x193*x22 + x195*x23 + x196*x683 + 0.55*x197*x22
    H_out[109] = x160*x82 + x200*x23 + 0.55*x201*x22 + x202*x22 + x203*x683
    H_out[110] = x22*x224 + x225*x23
    H_out[111] = x22*x232 + x23*x237
    H_out[112] = x22*x249 + x23*x248
    H_out[113] = x22*x254 + x23*x253
    H_out[114] = x22*x263 + x23*x264
    H_out[115] = x22*x268 + x23*x269
    H_out[116] = x22*x289 + 0.55*x22*x291 + x23*x293 + x284*x82 + x292*x683
    H_out[117] = x22*x311 + 0.55*x22*x312 + x23*x305 + x303*x82 + x309*x683
    H_out[118] = x22*x323 + 0.55*x22*x325 + x23*x326 + x317*x82 + x327*x683
    H_out[119] = 0.55*x22*x331 + x22*x334 + x23*x337 + x332*x82 + x335*x683
    H_out[120] = x22*x354 + x23*x353
    H_out[121] = x22*x369 + x23*x370
    H_out[122] = x22*x379 + x23*x382
    H_out[123] = x22*x388 + x23*x389
    H_out[124] = x22*x396 + x23*x399
    H_out[125] = x22*x406 + x23*x405
    H_out[126] = x22*x423 + 0.55*x22*x427 + x23*x431 + x425*x82 + x428*x683
    H_out[127] = x22*x454 + 0.55*x22*x455 + x23*x452 + x444*x82 + x451*x683
    H_out[128] = 0.55*x22*x462 + x22*x468 + x23*x473 + x463*x683 + x472*x82
    H_out[129] = 0.55*x22*x485 + x22*x487 + x23*x484 + x477*x82 + x483*x683
    H_out[130] = x22*x511 + x23*x510
    H_out[131] = x22*x526 + x23*x529
    H_out[132] = x22*x546 + x23*x547
    H_out[133] = x22*x551 + x23*x554
    H_out[134] = x22*x566 + x23*x567
    H_out[135] = x22*x575 + x23*x574
    H_out[136] = 0.55*x22*x585 + x22*x599 + x23*x604 + x603*x82 + x605*x683
    H_out[137] = x22*x630 + 0.55*x22*x634 + x23*x633 + x615*x82 + x632*x683
    H_out[138] = 0.55*x22*x645 + x22*x653 + x23*x658 + x655*x82 + x659*x683
    H_out[139] = x22*x676 + 0.55*x22*x678 + x23*x680 + x666*x82 + x679*x683
    # H_out[140] = 0
    # H_out[141] = 0
    # H_out[142] = 0
    # H_out[143] = 0
    # H_out[144] = 0
    # H_out[145] = 0
    # H_out[146] = 0
    # H_out[147] = 0
    # H_out[148] = 0
    # H_out[149] = 0
    # H_out[150] = 0
    # H_out[151] = 0
    # H_out[152] = 0
    # H_out[153] = 0
    # H_out[154] = 0
    # H_out[155] = 0
    # H_out[156] = 0
    # H_out[157] = 0
    # H_out[158] = 0
    # H_out[159] = 0
    H_out[160] = x41
    H_out[161] = x50
    H_out[162] = x53
    H_out[163] = x63
    H_out[164] = x67
    H_out[165] = x68
    H_out[166] = 0.045*x69 + x86
    H_out[167] = 0.045*x49
    H_out[168] = 0.045*x96 + x99
    H_out[169] = 0.045*x87
    H_out[170] = x112
    H_out[171] = x123
    H_out[172] = x135
    H_out[173] = x140
    H_out[174] = x148
    H_out[175] = x150
    H_out[176] = 0.045*x131 + x163
    H_out[177] = 0.045*x180 + x189
    H_out[178] = 0.045*x190 + x198
    H_out[179] = 0.045*x160 + x199
    H_out[180] = x223
    H_out[181] = x238
    H_out[182] = x250
    H_out[183] = x255
    H_out[184] = x261
    H_out[185] = x267
    H_out[186] = 0.045*x284 + x285
    H_out[187] = 0.045*x303 + x304
    H_out[188] = 0.045*x317 + x320
    H_out[189] = 0.045*x332 + x338
    H_out[190] = x355
    H_out[191] = x368
    H_out[192] = x383
    H_out[193] = x387
    H_out[194] = x400
    H_out[195] = x404
    H_out[196] = 0.045*x425 + x432
    H_out[197] = 0.045*x444 + x447
    H_out[198] = 0.045*x472 + x474
    H_out[199] = 0.045*x477 + x479
    H_out[200] = x509
    H_out[201] = x530
    H_out[202] = x545
    H_out[203] = x555
    H_out[204] = x565
    H_out[205] = x573
    H_out[206] = 0.045*x603 + x606
    H_out[207] = 0.045*x615 + x626
    H_out[208] = 0.045*x655 + x660
    H_out[209] = 0.045*x666 + x672
    # H_out[210] = 0
    # H_out[211] = 0
    # H_out[212] = 0
    # H_out[213] = 0
    # H_out[214] = 0
    # H_out[215] = 0
    # H_out[216] = 0
    # H_out[217] = 0
    # H_out[218] = 0
    # H_out[219] = 0
    # H_out[220] = 0
    # H_out[221] = 0
    # H_out[222] = 0
    # H_out[223] = 0
    # H_out[224] = 0
    # H_out[225] = 0
    # H_out[226] = 0
    # H_out[227] = 0
    # H_out[228] = 0
    # H_out[229] = 0
    # H_out[230] = 0
    # H_out[231] = 0
    # H_out[232] = 0
    # H_out[233] = 0
    # H_out[234] = 0
    # H_out[235] = 0
    # H_out[236] = 0
    # H_out[237] = 0
    # H_out[238] = 0
    # H_out[239] = 0
    H_out[240] = x113
    H_out[241] = x126
    H_out[242] = x138
    H_out[243] = x119
    H_out[244] = x147
    H_out[245] = x121
    H_out[246] = 0.045*x164 + x174
    H_out[247] = 0.045*x126
    H_out[248] = x191 + 0.045*x192
    H_out[249] = 0.045*x182
    H_out[250] = x224
    H_out[251] = x232
    H_out[252] = x249
    H_out[253] = x254
    H_out[254] = x263
    H_out[255] = x268
    H_out[256] = x287 + 0.045*x288
    H_out[257] = 0.045*x306 + x310
    H_out[258] = 0.045*x321 + x322
    H_out[259] = 0.045*x328 + x333
    H_out[260] = x354
    H_out[261] = x369
    H_out[262] = x379
    H_out[263] = x388
    H_out[264] = x396
    H_out[265] = x406
    H_out[266] = x421 + 0.045*x422
    H_out[267] = 0.045*x448 + x453
    H_out[268] = 0.045*x461 + x467
    H_out[269] = 0.045*x480 + x486
    H_out[270] = x511
    H_out[271] = x526
    H_out[272] = x546
    H_out[273] = x551
    H_out[274] = x566
    H_out[275] = x575
    H_out[276] = 0.045*x580 + x598
    H_out[277] = 0.045*x627 + x629
    H_out[278] = 0.045*x644 + x652
    H_out[279] = 0.045*x673 + x675
    # H_out[280] = 0
    # H_out[281] = 0
    # H_out[282] = 0
    # H_out[283] = 0
    # H_out[284] = 0
    # H_out[285] = 0
    # H_out[286] = 0
    # H_out[287] = 0
    # H_out[288] = 0
    # H_out[289] = 0
    # H_out[290] = 0
    # H_out[291] = 0
    # H_out[292] = 0
    # H_out[293] = 0
    # H_out[294] = 0
    # H_out[295] = 0
    # H_out[296] = 0
    # H_out[297] = 0
    # H_out[298] = 0
    # H_out[299] = 0
    # H_out[300] = 0
    # H_out[301] = 0
    # H_out[302] = 0
    # H_out[303] = 0
    # H_out[304] = 0
    # H_out[305] = 0
    # H_out[306] = 0
    # H_out[307] = 0
    # H_out[308] = 0
    # H_out[309] = 0
    # H_out[310] = 0
    # H_out[311] = 0
    # H_out[312] = 0
    # H_out[313] = 0
    # H_out[314] = 0
    # H_out[315] = 0
    # H_out[316] = 0
    # H_out[317] = 0
    # H_out[318] = 0
    # H_out[319] = 0
    H_out[320] = x212
    H_out[321] = x235
    H_out[322] = x241
    H_out[323] = x251
    H_out[324] = x260
    H_out[325] = x266
    H_out[326] = x283
    # H_out[327] = 0
    H_out[328] = x314
    # H_out[329] = 0
    H_out[330] = x349
    H_out[331] = x363
    H_out[332] = x380
    H_out[333] = x384
    H_out[334] = x397
    H_out[335] = x403
    H_out[336] = x430
    H_out[337] = x446
    H_out[338] = x469
    # H_out[339] = 0
    H_out[340] = x505
    H_out[341] = x528
    H_out[342] = x540
    H_out[343] = x552
    H_out[344] = x561
    H_out[345] = x569
    H_out[346] = x600
    H_out[347] = x625
    H_out[348] = x656
    H_out[349] = x668
    # H_out[350] = 0
    # H_out[351] = 0
    # H_out[352] = 0
    # H_out[353] = 0
    # H_out[354] = 0
    # H_out[355] = 0
    # H_out[356] = 0
    # H_out[357] = 0
    # H_out[358] = 0
    # H_out[359] = 0
    # H_out[360] = 0
    # H_out[361] = 0
    # H_out[362] = 0
    # H_out[363] = 0
    # H_out[364] = 0
    # H_out[365] = 0
    # H_out[366] = 0
    # H_out[367] = 0
    # H_out[368] = 0
    # H_out[369] = 0
    # H_out[370] = 0
    # H_out[371] = 0
    # H_out[372] = 0
    # H_out[373] = 0
    # H_out[374] = 0
    # H_out[375] = 0
    # H_out[376] = 0
    # H_out[377] = 0
    # H_out[378] = 0
    # H_out[379] = 0
    # H_out[380] = 0
    # H_out[381] = 0
    # H_out[382] = 0
    # H_out[383] = 0
    # H_out[384] = 0
    # H_out[385] = 0
    # H_out[386] = 0
    # H_out[387] = 0
    # H_out[388] = 0
    # H_out[389] = 0
    # H_out[390] = 0
    # H_out[391] = 0
    # H_out[392] = 0
    # H_out[393] = 0
    # H_out[394] = 0
    # H_out[395] = 0
    # H_out[396] = 0
    # H_out[397] = 0
    # H_out[398] = 0
    # H_out[399] = 0
    H_out[400] = x351
    H_out[401] = x365
    H_out[402] = x373
    H_out[403] = x361
    H_out[404] = x395
    H_out[405] = x360
    H_out[406] = x420
    # H_out[407] = 0
    H_out[408] = x464
    # H_out[409] = 0
    H_out[410] = x506
    H_out[411] = x519
    H_out[412] = x542
    H_out[413] = x550
    H_out[414] = x562
    H_out[415] = x570
    H_out[416] = x591
    H_out[417] = x623
    H_out[418] = x651
    H_out[419] = x670
    # H_out[420] = 0
    # H_out[421] = 0
    # H_out[422] = 0
    # H_out[423] = 0
    # H_out[424] = 0
    # H_out[425] = 0
    # H_out[426] = 0
    # H_out[427] = 0
    # H_out[428] = 0
    # H_out[429] = 0
    # H_out[430] = 0
    # H_out[431] = 0
    # H_out[432] = 0
    # H_out[433] = 0
    # H_out[434] = 0
    # H_out[435] = 0
    # H_out[436] = 0
    # H_out[437] = 0
    # H_out[438] = 0
    # H_out[439] = 0
    # H_out[440] = 0
    # H_out[441] = 0
    # H_out[442] = 0
    # H_out[443] = 0
    # H_out[444] = 0
    # H_out[445] = 0
    # H_out[446] = 0
    # H_out[447] = 0
    # H_out[448] = 0
    # H_out[449] = 0
    # H_out[450] = 0
    # H_out[451] = 0
    # H_out[452] = 0
    # H_out[453] = 0
    # H_out[454] = 0
    # H_out[455] = 0
    # H_out[456] = 0
    # H_out[457] = 0
    # H_out[458] = 0
    # H_out[459] = 0
    # H_out[460] = 0
    # H_out[461] = 0
    # H_out[462] = 0
    # H_out[463] = 0
    # H_out[464] = 0
    # H_out[465] = 0
    # H_out[466] = 0
    # H_out[467] = 0
    # H_out[468] = 0
    # H_out[469] = 0
    # H_out[470] = 0
    # H_out[471] = 0
    # H_out[472] = 0
    # H_out[473] = 0
    # H_out[474] = 0
    # H_out[475] = 0
    # H_out[476] = 0
    # H_out[477] = 0
    # H_out[478] = 0
    # H_out[479] = 0
    H_out[480] = x497
    H_out[481] = x523
    H_out[482] = x532
    H_out[483] = x496
    H_out[484] = x556
    H_out[485] = x533
    H_out[486] = x596
    H_out[487] = x619
    # H_out[488] = 0
    # H_out[489] = 0
#
    return H_out


